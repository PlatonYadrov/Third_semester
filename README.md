# [First_contest](https://github.com/PlatonYadrov/Third_semester/tree/main/first_contest)
## [A. Копатыч и искусство легких касаний](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/A.cpp)
За окном rain, на душе pain, а смешарики устраивают смотр ледяных скульптур! Правила конкурса следующие: статуи выставляются в ряд, каждый смешарик голосует за понравившиеся ему бюсты. После этого Копатыч, как единственный независимый судья (независимый, потому что проспал весь творческий процесс) пытается определить лучшую ледяную композицию.

По мнению медведя композицией может быть любой подотрезок из ряда скульптур (Копатыч сельский житель и плохо разбирается в искусстве). Также Копатыч верит в то, что лучшая композиция — композиция, у скульптур в которой суммарное количество голосов максимально.

Помогите Копатычу написать программу, которая по его запросу будет говорить суммарное количество голосов за ледяную композицию.
### Формат ввода
В первой строке вводится одно натуральное число N(1≤N≤10<sup>5</sup>) — количество скульптур, выставленных в ряд.

Во второй строке вводятся N чисел от 1 до 10<sup>5</sup> — количество голосов у скульптур в ряду.

В третьей строке вводится одно натуральное число K(1≤K≤3⋅10<sup>4</sup>) — количество запросов Копатыча.

В следующих K строках вводится по два числа — номера левого и правого концов композиции (считается, что скульптуры нумеруются с единицы).
### Формат вывода
Для каждого запроса выведите сумму чисел соответствующей композиции скульптур. Числа выводите в одну строку через пробел.
## [B. История Кар-Карыча или Несколько мелочей на фоне природы](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/B.cpp)
Кто-то за ночь уничтожил выставку ледяных скульптур. Известно, что ни одному из смешариков в одиночку не хватило бы времени на такое. Налицо тайный сговор или действия организованной преступной группировки. Смешарики решают провести суд Кар-Карычей — самый гуманный суд в мире. Всех смешариков построили в шеренгу, чтобы выявить самую подозрительную группировку.

Кар-Карыч считает, что группировкой может быть любой подотрезок из шеренги смешариков (общеизвестно, что все налетчики стараются держаться рядом). Также Кар-Карыч верит в то, что самая подозрительная группировка — группировка, у смешариков которой наибольшая суммарная подозрительность.

Помогите Кар-Карычу и напишите программу, которая найдет самую подозрительную группировку.
### Формат ввода
В первой строке дано натуральное число N (1≤n≤10<sup>5</sup>) — длина шеренги. Во второй строке через пробел перечислена подозрительность у каждого из смешариков (учтите, что она может быть отрицательной). Числа по модулю не превышают 10<sup>4</sup>.
### Формат вывода
В одну строку через пробел выведите границы группировки (в 1-индексации), а также ее подозрительность.
## [C. Пинкод](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/C.cpp)
Для новой серии научно-популярного шоу смешарикам необходимо найти в творческой команде самого сообразительного смешарика, принявшего участие в наименьшем количестве выпусков. Командой может быть любая шеренга смешариков. Вам следует помочь нашим героям с поиском самого редкого гостя на экране для каждой команды, которую они попросят.
### Формат ввода
В первой строке вводятся два числа 1≤n,q≤10<sup>5</sup> - число смешариков и число запросов. В следующей строке n чисел - количество выпусков с каждым из смешариков. В следующих q строках запросы 1≤l≤r≤n
### Формат вывода
Выведите ответы на q запросов
## [D. Шаровидение: Как стать звездой?](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/D.cpp)
Бараш тоже решил поруководить толпой и заодно попасть на Шаровидение. Он выстроил всех смешариков так, чтобы любой подотрезок шеренги был ансамблем песни и пляски.

Тонко чувствующему поэту позвонили с телевидения и сказали, что общая талантливость ансамбля равна НОДу талантов смешариков, состоящих в нем.

Вам нужно снова помочь одному из наших героев. Напишите программу, которая сможет отвечать на запросы о талантливости ансамблей.
### Формат ввода
В первой строке вводится одно натуральное число N (1≤N≤10<sup>5</sup>) — количество смешариков в шеренге.

Во второй строке вводятся N чисел от 1 до 10<sup>5</sup> — талантливость каждого смешарика.

В третьей строке вводится одно натуральное число K (1≤K≤3⋅10<sup>4</sup>) — количество запросов на вычисление талантливости ансамбля.

В следующих K строках вводится по два числа — номера левого и правого элементов концов шеренги в 1-индексации.
### Формат вывода
Для каждого запроса выведите талантливость музыкального коллектива. Разделяйте числа переводами строк.
## [E. Последняя ошибка Пина](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/E.cpp)
Пин готовится к технологической выставке, продумывая лучшую расстановку экспонатов. По мнению пингвина, расстановка будет наилучшей, если все его механизмы будут расположены вдоль одной прямой.

Теперь Пин ищет, а как лучше распределить устройства вдоль стенда, чтобы произвести впечатление на комиссию. Он попросил вас, как лучшего программиста Ромашковой долины, написать программу, которая сможет отвечать на два типа запросов:

* "s l r" — узнать суммарную технологическую сложность устройств, расположенных на отрезке [l,r] в 1-индексации;

* "u i v" — переставить приборы так, чтобы в позиции с индексом i технологическая сложность стала v. Считайте, что он просто заменяет технологическую сложность на позиции i на сложность v. Не задумывайтесь, как Пин это делает, - его гениальность нам не постижима.
### Формат ввода
В первой строке вводится одно натуральное число N (1≤N≤10<sup>5</sup>) — длина стенда.

Во второй строке вводятся N чисел от 0 до 10<sup>5</sup> — изначальная расстановка экспонатов.

В третьей строке вводится одно натуральное число M (1≤M≤3⋅10<sup>4</sup>) — количество запросов.

Каждая из следующих M строк представляет собой описание запроса в формате выше.
### Формат вывода
Для каждого запроса s выведите результат. Все числа выводите в одну строку через пробел.
## [F. Приключения Биби или Космическая одиссея](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/F.cpp)
Ромашковая долина наконец дождалась великого дня — робот Биби вернулся из космического путешествия во главе целой космической флотилии. По опыту Биби для космоса не существует трехмерной фигуры лучше куба, поэтому его космофлот выглядит как куб с длиной стороны N.

Для организации управления наш герой разделил исходный куб на N<sup>3</sup> кубиков с ребром длины 1.

Биби хочет научиться быстро обрабатывать запросы следующих типов:

* В каком-то секторе изменилось число космолетов;

* Узнать количество космолетов в прямоугольном параллелепипеде.
### Формат ввода
Первая строка входного файла содержит натуральное число 
N (N≤2<sup>7</sup>). Координаты секторов~--- целые числа от 0 до N−1. Далее следуют записи о происходивших событиях по одной в строке.

В начале строки записано число m. Если m равно:

* 1, то за ним следуют 4 числа: x,y,z,k (0≤x,y,z≤N,−20000≤k≤20000) — координаты сектора и величина, на которую в нем изменилось количество космолетов;

* 2, то за ним следуют 6 чисел: x<sub>1</sub>,y<sub>1</sub>,z<sub>1</sub>,x<sub>2</sub>,y<sub>2</sub>,z<sub>2</sub>(0≤x<sub>i</sub>,y<sub>i</sub>,z<sub>i</sub>≤N,x<sub>1</sub>≤x<sub>2</sub>,y<sub>1</sub>≤y<sub>2</sub>,z<sub>1</sub>≤z<sub>2</sub>), которые означают, что нужно узнать, сколько космолетов в прямоугольном параллелепипеде с данными противолежащими вершинами и сторонами, параллельными осям координат.

* 3, то это означает, что Биби утомился, а значит можно закончить работу программы.

Количество записей во входном файле не превосходит 100500. Изначально в воздухе нет ни одного космолета.
### Формат вывода
Для каждого запроса второго типа выведите на отдельной строке одно число~--- искомое количество космолетов.
## [G. История Кроша или Зачем нужны друзья?](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/G.cpp)
Наконец-то к популярному среди старшего поколения явлению потянулась и перспективная молодежь. Крош изучает тренды Шар-Тока и пытается найти лучших кандидатов для совместного видео. Чтобы видео залетело в тренды, нашему другу нужно знать, сколько именно смешариков в конкретном творческом объединении имеет максимальное число подписчиков.

Если вы вдруг забыли, то напомним, что жизнь в Шарараме примечательна тем, что любой подотрезок ряда является творческим объединением.
### Формат ввода
В первой строке вводится одно натуральное число N (1≤N≤10<sup>5</sup>)~--- количество смешариков в ряду.

Во второй строке вводятся N чисел от 1 до 10<sup>5</sup>~--- количество подписчиков у смешарика.

В третьей строке вводится одно натуральное число K (1≤K≤3⋅10<sup>4</sup>)~--- количество запросов Кроша.

В следующих K строках вводится по два числа~--- номера левого и правого смешарика, границ творческого объединения (в 1-индексации).
### Формат вывода
Для каждого запроса выведите в отдельной строке через пробел максимальное количество подписчиков у смешарика в указанном объединении и количество смешариков с числом подписчиков, равным максимальному.
## [H. Укуси меня пчела](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/H.cpp)
После ударного дачного сезона Копатыч расставил свои ульи в ряд, чтобы определить лучшую пчелиную семью (подотрезок ряда).

Качество пчелиной семьи Копатыч определяет по наибольшему количеству собранного меда в одном улье. Периодически Копатыч собирает дополнительный мед из того или иного улья.

Необходимо помочь Копатычу определить качество каждой пчелиной семьи и разобраться в его отношениях со сбором меда.
### Формат ввода
В первой строке вводится одно натуральное число N (1≤N≤100000) — количество ульев в ряду.

Во второй строке вводятся N чисел от 0 до 100000 — количество собранного меда с каждого улья в начальный момент.

В третьей строке вводится одно натуральное число M (1≤M≤30000) — количество запросов Копатыча.

Каждая из следующих M строк представляет собой описание запроса. Сначала вводится одна буква, кодирующая вид запроса (m — найти наибольшее число собранного меда в семье, a — увеличить число собранного меда у пчелиной семьи).

Следом за m вводятся два числа — левая и правая граница ряда.

Следом за a вводятся три числа — левый и правый концы ряда и число add, на которое нужно увеличить количество собранного меда у каждого улья данной пчелиной семьи (0≤add≤100000).
### Формат вывода
Выведите в одну строку через пробел ответы на каждый запрос m.
## [I. Нюша и Чёрный Ловелас](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/I.cpp)
«Вы пришли за моим сердцем? И я сойду с ума? Да?»

«Было бы очень некрасиво с моей стороны сводить с ума столь юную мадемуазель. Она тогда не сможет делать уроки. Увы, мне пора. Благодарю вас за столь приятное знакомство!»

«А когда я вырасту вы придете? А?»

«Все может быть.»

«Я буду ждать! Я буду ждать! Я обязательно буду ждать!»

Нюша собирается на свидание с Черным Ловеласом, но теряется в муках выбора --- ей совершенно нечего надеть. Бараш тоже мучается, но не может отказать в просьбе подруги — он предлагает присвоить каждому платью номер и приоритет. Тогда, если смешарики расположат одежду Нюши как вершины в декартовом дерева поиска, то смогут подбирать ее математически обоснованно.

Так как Бараш, как и всегда, торопится использовать состояние гипомании с максимальной пользой, ему нужно построить дерево для хранения информации о машинах за линейное время от количества нарядов.
### Формат ввода
В первой строке записано число N — количество пар номер-приоритет. Далее следует N (1≤N≤50000) пар (a<sub>i</sub>,b<sub>i</sub>). Для всех пар |a<sub>i</sub>|, |b<sub>i</sub>|≤30000. a<sub>i</sub>≠a<sub>j</sub> и b<sub>i</sub>≠b<sub>j</sub> для всех i≠j. Гарантируется, что пары отсортированы по возрастанию a<sub>i</sub>.
### Формат вывода
Если Нюша с Барашом выбрали неверные приоритеты, и дерево построить невозможно, то выведите NO. Иначе выведите N строк, каждая из которых должна описывать вершину. Вершины надо выводить в порядке прямого обхода. Описание вершины состоит из трёх чисел: номер предка, номер левого сына и номер правого сына. Если у вершины отсутствует предок или какой-либо из сыновей, то выводите на его месте число 0.

Если подходящих деревьев несколько, выведите любое.
## [J. День рождения Кар-Карыча или трагедия на фоне одиночества](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/J.cpp)
Как живут смешарики? Так будто собираются жить вечно. И друзья их будут жить вечно, и родственники… Поэтому обязательно нужно соблюдать все эти условности: пригласил меня Кар-Карыч на день рождения — надо идти. Но перед тем как идти, надо же ещё обязательно спросить: «А что же тебе подарить, дорогой мой пернатый друг?». Предположив тем самым, что именно за этим-то он вас и позвал, чтоб вы ему что-нибудь этакое подарили. А если не позвал? Тогда надо сидеть гордо дома и дуться, лишь написав прислав письмо или позвонив. В этой задаче вам предстоит доказать, что вы достойный член маленькой общины, и рады дням рождениям своих друзей, как своему. А именно, вам предстоит реализовать сбалансированное дерево смешариков.
### Формат ввода
Входной файл содержит описание операций с деревом смешариков, их количество не превышает 10<sup>5</sup>. В каждой строке находится одна из следующих операций.

* insert x — добавить в дерево смешарика с настроением x. Если такой уже есть, то ничего делать не надо.

* delete x — удалить из дерева смешарика с настроением x. Если его там нет, то ничего делать не надо.

* exists x — если имеется смешарик с настроением x, выведите true, иначе, false.

* next x — выведите настроение такого смешарика, что оно лучше чем x, но минимально среди таких или none, если такого нет. Это нужно, чтобы понимать, кто наполнит светом маленький праздник, а кому стоит передохнуть наедине с собой.

* prev x — выведите настроение такого смешарика, что оно хуже чем x, но максимально среди таких или none, если такого нет.

* kth k — выведите k-ю величину настроения (нумерация с нуля). Если такого не существует, то выведите none.

Все числа во входном файле по модулю не превышают 10<sup>9</sup>.
### Формат вывода
Выведите последовательно результат выполнения всех операций выше. Следуйте формату выходного файла из примера.
## [K. Как собрать друзей по-быстрому](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/K.cpp)
Собирать гостей — большая наука. Одного радушия порой маловато, требуется выдумка и недюжинная смелость. Поэтому Нюша берётся за дело: притворившись больной, она просит друзей навестить её. Реализуйте структуру данных, которая поддерживает множество S целых чисел порядковых номеров смешариков (это число показывает, каким смешарик пришел на фан-встречу: пятым, десятым, пятидесятым…), с которым разрешается производить следующие операции:

* add(i) — добавить в множество гостей S число i  — настроение пришедшего к Нюше смешарика (если оно там уже есть, то множество не меняется);

* sum(l, r) — вывести сумму всех элементов x из S, которые удовлетворяют неравенству l ≤ x ≤ r. Нюша хочет знать как зависит настроение смешарика от времени, от его порядковой позиции в списке гостей.
### Формат ввода
Исходно множество S пусто. Первая строка входного файла содержит n — количество операций (1 ≤ n ≤ 3 ⋅ 10<sup>5</sup>). Следующие n строк содержат операции. Каждая операция имеет вид либо «+ i», либо «? l r». Операция «+ i» задает запрос add(i). Операция «? l r» задает запрос sum(l, r).

Во всех запросах и операциях добавления параметры лежат в интервале от 0 до 10<sup>9</sup>.
### Формат вывода
Для каждого запроса выведите одно число — ответ на запрос.
## [L. Ёжик и Кордебалет](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/L.cpp)
Ёжика вновь назначили ответственным за репетицию кордебалета. И вот смешарики под угрозой записи в книжечку вновь выстроились в шеренгу и рассчитались по порядку (с 1 по n).

В поисках оптимального построения Ёжик то и дело отдает команды перестроения шеренги. Звучат они так: Смешарики с l<sub>i</sub> по r<sub>i</sub> — в начало!. После этой команды смешарики стоящие в позициях с l<sub>i</sub> по r<sub>i</sub> включительно, немедленно перемещаются в начало шеренги, сохраняя относительный порядок.

Например, если в некоторый момент смешарики стоят в порядке 2,3,6,1,5,4 (каждому смешарику присвоен свой номер), то после команды: Смешарики с 2 по 4 — в начало! порядок будет 3,6,1,2,5,4.

Помогите Ёжику разобраться, в каком порядке должны стоять смешарики после выполнения всех его команд, иначе он вас запишет в книжечку.
### Формат ввода
В первой строке два целых числа n and m (2≤n≤100000,1≤m≤100000) — количество смешариков и количество команд от Ёжика. Следующие m строк содержат по два целых числа l<sub>i</sub> и r<sub>i</sub> (1≤l<sub>i</sub>≤r<sub>i</sub>≤n).
### Формат вывода
Выведите n целых чисел — порядок после выполнения всех команд.
## [M. Совунья и чистый спорт](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/M.cpp)
Смешарики устали сжигать калории на диете тревог и забот, поэтому сегодня происходит торжественное открытие Спартакиады. Совунье выпала честь наградить всех участников соревнований памятными наградами. Смешарики снова стоят в один ряд, а спортивной командой Совунья называет любой подотрезок этого ряда. Изначально у всех смешариков ноль наград, так что ваша задача — помочь провести награждение максимально быстро. Для этого Совунья сообщила вам, что смешариков всегда n=2<sup>24</sup>.

Собственно, награждение устроено достаточно просто, Совунья называет спортивную команду и количество наград, которое надо начислить смешарикам в команде. Всего таких «стадий награждения» будет m.

Совунья хочет знать, не потратит ли она так все имеющиеся медали, а поэтому просит вас определить, сколько будет наград у команд после церемонии награждения. Таких запросов будет q.
### Формат ввода
В первой строке числа m,q (1≤m,q≤2<sup>24</sup>). Во второй строке пара целых чисел a, b от 1 до 10<sup>9</sup>, используемая в генераторе случайных чисел, который был разработан математиками Шарарама.

__unsigned int a, b;__ // даны во входных данных

__unsigned int cur = 0;__ // беззнаковое 32-битное число

__unsigned int nextRand() {__

__cur = cur * a + b;__ // вычисляется с переполнениями

__return cur >> 8;__ // число от 0 до 2<sup>24</sup>−1.

__}__

Каждый запрос первого вида генерируется следующим образом:

__add = nextRand();__ // число, которое нужно прибавить

__l = nextRand();__

__r = nextRand();__

__if (l > r) swap(l, r);__ // получили отрезок [l..r]

Каждый запрос второго вида генерируется следующим образом:

__l = nextRand();__

__r = nextRand();__

__if (l > r) swap(l, r);__ // получили отрезок [l..r]

Сперва генерируются запросы на награждение, затем запросы наград у команды.
### Формат вывода
Выведите сумму ответов на все запросы второго типа по модулю 2<sup>32</sup>.
## [N. Пинкод 2D](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/N.cpp)
Смешарики открыли для себя 2D-строй — теперь построение будет не в одну шеренгу, а в прямоугольник. Для новой серии научно-популярного шоу смешарикам необходимо найти в творческой команде самого сообразительного смешарика, принявшего участие в наименьшем количестве выпусков. Командой может быть любой подпрямоугольник смешариков. Вам нужно помочь нашим героям для каждой команды, которую они попросят, найти самого редкого гостя на экране.
### Формат ввода
Первая строка входного файла содержит числа m и n — размеры прямоугольника (1≤m,n≤500). Следующие m строк содержат по n целых чисел каждая — количество появлений определенного смешарика в шоу. Все числа между −2<sup>31</sup> и 2<sup>31</sup>-1.

Далее следует q — количество запросов (1≤q≤2⋅10<sup>5</sup>). Следующие q строк содержат по четыре целых числа: 
x<sub>1</sub>,y<sub>1</sub>,x<sub>2</sub>,y<sub>2</sub> 
(1≤x<sub>1</sub>≤x<sub>2</sub>≤m,1≤y<sub>1</sub>≤y<sub>2</sub>≤n) — границы команды в запросе.
### Формат вывода
Выведите q чисел — для каждого запроса выведите минимальное значение в соответствующем прямоугольнике.
## [O. Лосяш и торжество разума](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/O.cpp)
Лосяш разработал новый язык — язык скобочных последовательностей, словом в котором является строка s длины n, состоящая из символов <<(>> и <<)>>.

Естественно, Лосяш заметил, что в его языке есть правильные слова (для остального мира это всеми любимые правильные скобочные последовательности). Наш герой подготовил целую речь на новом языке, но он расстроен тем, что в ней слишком много неправильных фрагментов.

Вам нужно утешить смешарика и написать программу, которая по фрагменту из речи сможет сказать размер наидлиннейшего правильного подслова в нем.
### Формат ввода
Первая строка содержит речь Лосяша — скобочная последовательность длины n (1≤n≤10<sup>6</sup>).

Вторая строка содержит целое число m (1≤m≤10<sup>5</sup>) — количество запросов к написанной вами программе.

Каждая из следующих m строк содержит пару целых чисел. В i-й строке записаны числа l<sub>i</sub> и r<sub>i</sub> (1≤l<sub>i</sub>≤r<sub>i</sub>≤n) — границы i-го фрагмента.
### Формат вывода
Выведите ответ на каждый запрос в отдельной строке. Ответы выводите в порядке следования запросов во входных данных.
## [P. Смешарики переходят на второй курс](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/P.cpp)
Скоро начало учебного года, а значит, многие смешарики вынуждены переселяться из привычного коридорного общежития в апартаменты премиум-класса. К сожалению, недобросовестные смешарики постоянно затягивают свой переезд, поэтому новичкам Шарарама приходится въезжать в комнаты, заполненные вещами дедов. В некоторых общежитиях практикуется выставление вещей предыдущих жильцов за дверь (иногда даже самими предыдущими жильцами), позднее кто-то (доподлинно неизвестно, кто) эти вещи забирает. Однако выставленные в проход вещи противоречат технике пожарной безопасности, а проверка регулярно посещает общежития.

Итак, сама задача: в общежитии имеется длинный основной коридор, который никак не должен быть захламлен по ТБ, но на мелкие нарушения проверка готова закрыть глаза. В этот коридор постоянно кто-то выставляет вещи, а кто-то постоянно их оттуда забирает. Когда приходит проверка, она считает, сколько предметов выставлено в коридор между двумя комнатами с заданными номерами (эти номера выбираются комиссией, проводящей проверку). Смоделируйте происходящее на языке C++.
### Формат ввода
В первой строке входного файла содержатся два числа: N --- максимальный номер комнаты (1≤N≤10000) и M --- количество производимых в коридоре действий (1≤M≤50000). Каждое действие имеет вид "1 L R S", что означает, что на участок коридора от L-ой комнаты до R-ую комнаты между всеми соседними комнатами выставили S предметов (S может быть и отрицательным, тогда это означает, что предметы из коридора забрали), или "2 L R", что значит, что проверка интересуется, сколько предметов выставлено на участке коридора от L-ой комнаты до R-й. Комнаты нумеруются от 0 до N. Гарантируется, что для запросов вида "1 L R S" при S<0 на каждом участке между соседними комнатами от L до R число предметов составляет не менее S.
### Формат вывода
На каждую команду 2 (запрос) вы должны выводить число K --- суммарное число предметов, находящихся между L-й и R-й комнатами. Каждое число должно выводиться на новой строке. Известно, что в процессе работы суммарное количество предметов на любом интервале не превышает 2<sup>31</sup>.
## [Q. Бараш или смысл жизни](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/Q.cpp)
Бараш разрабатывает математическую теорию, описывающую его эмоции. Его последние исследования посвящены изучению того, насколько хорошие и плохие дни влияют на его воспоминания о различных периодах жизни.

Недавно Бараш придумал методику, которая описывает, насколько хорошим или плохим был его день с помощью сопоставления дню некоторого неотрицательного целого числа. Он называет это число эмоциональной значимостью этого дня. Чем больше это число, тем лучше этот день. Наш поэт полагает, что значимость некоторого периода жизни равна сумме эмоциональных значимостей каждого из дней периода, помноженной на минимум эмоциональных значимостей дней этого периода. Эта методика отражает то, что период, который в среднем может быть весьма неплох, бывает испорчен одним плохим днем.

Теперь наш герой хочет проанализировать свою собственную жизнь и найти в ней период максимальной значимости. Помогите ему это сделать.
### Формат ввода
Первая строка входного файла содержит число N — количество дней в жизни Бараша, которые он хочет исследовать (1≤N≤10<sup>5</sup>). Оставшаяся часть файла содержит N целых чисел, все в пределах от 0 до 10<sup>6</sup> — эмоциональные значимости дней. Числа во входном файле разделяются пробелами и переводами строки.
### Формат вывода
В первой строке выходного файла выведите максимальную значимость периода жизни Бараша. Во второй строке выведите два числа l и r, означающие, что значимость периода с l-го по r-й день (включительно) в жизни Бараша была максимально возможной.
## [R. RMQ + insert](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/R.cpp)
Вы уже решали задачу RMQ, даже если есть обновления на отрезке. В этот раз границы решения этой задачи будут расширены. А именно, надо разработать структуру данных в виде массива, который умеет обрабатывать следующие запросы:

* «? l r» — найти минимум на отрезке [l, r] в 1-индексации;

* «+ i x» — добавить элемент x после i-го (в 1-индексации) элемента. Если i = 0, то вставка идет в начало списка.

Изначально структура пустая.
### Формат ввода
Первая строка входного файла содержит единственное целое число n — число операций над массивом (1 ≤ n ≤ 2 ⋅ 10<sup>5</sup>). Следующие n строк описывают сами операции. Все операции добавления являются корректными. Все числа, хранящиеся в массиве, по модулю не превосходят 10<sup>9</sup>.
### Формат вывода
Для каждой операции в отдельной строке выведите её результат.
## [S. RMQ + Reverse](https://github.com/PlatonYadrov/Third_semester/blob/main/first_contest/S.cpp)
Мы опять решаем задачу RMQ, только теперь нужно обработать следующие запросы:

* <<1 l r>> — развернуть отрезок [l,r].

* <<2 l r>> — найти минимум на отрезке [l,r];
### Формат ввода
Первая строка файла содержит два числа n, m. (1≤n,m≤10<sup>5</sup>) Во второй строке находится n чисел a<sub>i</sub> (1≤<sub>i</sub>≤10<sup>9</sup>) — исходный массив. Остальные m строк содержат запросы в формате, описанном в условии. Для чисел l,r выполняется ограничение (1≤l≤r≤n).
### Формат вывода
На каждый запрос типа 2, во входной файл выведите ответ на него, в отдельной строке.
